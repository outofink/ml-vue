<!DOCTYPE html>
<html>

<head>
    <title>Morfix Lite</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#3f51b5">
    <link rel="manifest" href="manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link href="./css/material.min.css" rel="stylesheet" type="text/css">
    <link href="./css/styles.css" rel="stylesheet" type="text/css">
    <link href="./icons/ml192.png" rel="icon" sizes="192x192">
    <script async defer src="./js/material.min.js"></script>
</head>

<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row row">
                <span class="mdl-layout-title">Morfix Lite</span>
                <div class="mdl-layout-spacer"></div>
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label" id="searchbar">
                    <label class="mdl-button mdl-js-button mdl-button--icon" for="search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                                fill="white"></path>
                            <path d="M0 0h24v24H0z" fill="none"></path>
                        </svg>
                    </label>
                    <div class="mdl-textfield__expandable-holder">
                        <form method="POST" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" onsubmit="loading()">
                            <input class="mdl-textfield__input text-heb" type="text" id="search" name="search">
                        </form>
                    </div>
                </div>
            </div>
        </header>
        <main class="mdl-layout__content background" id="main">
            <div class="page-content">
                <div class="mdl-grid content-grid">
                    <h3 class="center" id="title">Touch to search</h3>
                    <div class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active" id="spinner" style="display:none"></div>
                </div>
            </div>
        </main>
    </div>
</body>

</html>
<script>
    function loading() {
        var cards = document.getElementsByClassName("card")
        for (var i = 0; i < cards.length; i++) {
            cards[i].style.display = "none"
        }

        var title = document.getElementById("title")
        var query = document.getElementById("search")
        title.innerHTML = query.value

        query.blur()

        var searchbar = document.getElementById("searchbar")
        searchbar.className =
            "mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label is-upgraded"

        var loadingicon = document.getElementById("spinner")
        loadingicon.style = ""
    }
    document.getElementById("main").addEventListener('click', function (e) {
        if (e.target.tagName !== "H3" && e.target.tagName !== "MAIN") return
        var query = document.getElementById("search")
        query.focus()
    });
    var query = document.getElementById("search")

    query.addEventListener('input', function (e) {
        if (containsEnglish(query.value)) {
            query.className = "mdl-textfield__input text-eng"
        } else {
            query.className = "mdl-textfield__input text-heb"
        }
    }, false);

    containsEnglish = function (text) {
        if (!text) return false
        return text.match(/^[a-zA-Z(?:^| )[0-9]+(?:\.[0-9]+)?(?: |$)$]*$/)
    }
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
            navigator.serviceWorker.register('/service-worker.js').then(function (registration) {
                // Registration was successful
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, function (err) {
                // registration failed :(
                console.log('ServiceWorker registration failed: ', err);
            });
        });
    }
</script>
